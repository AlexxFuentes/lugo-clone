///-----------------------------------------------USUARIOS
var usuarios = [
    {
        nombre:"Pedro",
        apellido:"Martinez",
        ordenes:[
            {
                nombreProducto:"Producto 1",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                cantidad:2,
                precio:49.99
            },
            {
                nombreProducto:"Producto 2",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                cantidad:2,
                precio:49.99
            }
        ]
    },
    {
        nombre:"Juan",
        apellido:"Perez",
        ordenes:[
            {
                nombreProducto:"Producto 3",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                cantidad:2,
                precio:49.99
            },
            {
                nombreProducto:"",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                cantidad:2,
                precio:49.99
            }
        ]
    },
    {
        nombre:"Maria",
        apellido:"Rodriguez",
        ordenes:[
            {
                nombreProducto:"Producto 4",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                cantidad:2,
                precio:49.99
            },
            {
                nombreProducto:"Producto 1",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                cantidad:2,
                precio:49.99
            }
        ]
    }
];
///-----------------------------------------------CATEGORIAS
var categorias = [
    {
        nombreCategoria:"Farmacias",
        descripcion:"Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
        color:"#9482C4",
        icono:"fab fa-angellist",
        empresas:[
            {
                nombreEmpresa: "Empresa 1",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 2",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 3",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            }
        ]
    },
    {
        nombreCategoria:"Restaurantes",
        descripcion:"Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
        color:"#9482C4",
        icono:"fab fa-angellist",
        empresas:[
            {
                nombreEmpresa: "Empresa 1",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 2",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 3",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            }
        ]
    },
    {
        nombreCategoria:"Salud",
        descripcion:"Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
        color:"#9482C4",
        icono:"fab fa-angellist",
        empresas:[
            {
                nombreEmpresa: "Empresa 1",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 2",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 3",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            }
        ]
    },
    {
        nombreCategoria:"CafÃ©",
        descripcion:"Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
        color:"#9482C4",
        icono:"fab fa-angellist",
        empresas:[
            {
                nombreEmpresa: "Empresa 1",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 2",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 3",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            }
        ]
    },
    {
        nombreCategoria:"Bebidas",
        descripcion:"Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
        color:"#9482C4",
        icono:"fab fa-angellist",
        empresas:[
            {
                nombreEmpresa: "Empresa 1",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 2",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 3",
                imagen:"img/banner.jpg",
                productos:[
                    {
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            }
        ]
    }
];

console.log ('Usuarios', usuarios);
console.log ('Categorias', categorias);

document.addEventListener('DOMContentLoaded', ()=> {
    localStorage.setItem('categorias', JSON.stringify(categorias));
    localStorage.setItem('usuarios', JSON.stringify(usuarios));
    cargarCategorias();
    cargarUsuarios();
});

const listaUsuarios = document.querySelector('#usuarioActual');
const modalEmpresa = document.getElementById('modal-productos');
const divCategorias = document.querySelector('#div-categorias');
const selectEmpresas = [
    {
        nombreEmpresa: "Empresa 1",
        imagen:"img/banner.jpg",
        productos:[
            {
                nombreProducto: "Producto 1",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                precio: 49.99
            },
            {
                nombreProducto: "Producto 2",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                precio: 49.99
            },
            {
                nombreProducto: "Producto 3",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                precio: 49.99
            },
            {
                nombreProducto: "Producto 4",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                precio: 49.99
            }
        ]
    },
    {
        nombreEmpresa: "Empresa 2",
        imagen:"img/banner.jpg",
        productos:[
            {
                nombreProducto: "Producto 1",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                precio: 49.99
            },
            {
                nombreProducto: "Producto 2",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                precio: 49.99
            },
            {
                nombreProducto: "Producto 3",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                precio: 49.99
            },
            {
                nombreProducto: "Producto 4",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                precio: 49.99
            }
        ]
    },
    {
        nombreEmpresa: "Empresa 3",
        imagen:"img/banner.jpg",
        productos:[
            {
                nombreProducto: "Producto 1",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                precio: 49.99
            },
            {
                nombreProducto: "Producto 2",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                precio: 49.99
            },
            {
                nombreProducto: "Producto 3",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                precio: 49.99
            },
            {
                nombreProducto: "Producto 4",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                precio: 49.99
            }
        ]
    }
]

/**
 * Carga un modal para la categoria seleccionada y
 * muestra la informacion de las empresas y los productos
 * ofrece la empresa
 */
let categoriaID = -1;
function cargarEmpresasProductos(idcategoria) {
    categoriaID = idcategoria;
    const categorias = JSON.parse(localStorage.getItem('categorias'));
    const modalProductos = bootstrap.Modal.getOrCreateInstance('#modalNuevaApp');
    const tituloModal = document.querySelector('#id-header');
    const empresasModal = document.querySelector('#id-empresas');
    modalProductos.show();
    empresasModal.innerHTML = '';
    tituloModal.innerHTML = `<h1 class="modal-title fs-5" id="modalNuevaAppLabel">${categorias[idcategoria].nombreCategoria}</h1>`;
    
    categorias[idcategoria].empresas.forEach((element, index) => {
        empresasModal.innerHTML += 
        `<div class="col-12 col-md-12 col-lg-6 col-xl-6">
            <div class="card card-modal" style="width: 18rem;">
                <div class="card-cate">
                    <img src="${element.imagen}" class="card-img-top" alt="Logo ${element.nombreEmpresa}">
                    <h5 class="">${element.nombreEmpresa}</h5>
                </div>
                ${cargarProductos(categorias[idcategoria].empresas[index].productos, index)}
            </div>
        </div>`;
    });
}

/**
 * Retorna una lista de todos los productos de una empresa
 */
let empresaID = -1;
function cargarProductos(productos, idEmpresa) {
    empresaID = idEmpresa;
    let product = ``;
    productos.forEach((element, index) => {
        product += `
        <div id="product-${index}" class="card" style="width: 18rem;">
            <div class="card-cabecera">
                <h5 class="">${element.nombreProducto}</h5>
                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modal-nuevo-pedido" onclick="cargarNuevoPedido(${index})">Pedir</button>
            </div>
            <div class="card-body p-2">
                <p class="card-text p-3">${element.descripcion}</p>
                <h6 class="card-subtitle mb-2 text-muted texto">${element.precio}</h6>
            </div>
        </div>`;
    });
    return product;
}

/**
 * Carga en la ventana principal las categorias 
 * que se almacenaron en el localStorage
 */
function cargarCategorias() {
    const categorias = JSON.parse(localStorage.getItem('categorias'));
    const divCategorias = document.querySelector('#div-categorias');
    categorias.forEach((element, index) => {
        divCategorias.innerHTML += `
        <div class="col-12 col-sm-6 col-md-4 col-lg-3 col-xl-2 card-padding">
            <div class="card card-style" style="background-color: ${element.color};" onClick="cargarEmpresasProductos(${index})">
                <div class="icono">
                    <i class="${element.icono}"></i>
                </div>
                <div class="card-body card-body-style">
                    <h5 class="card-title">${element.nombreCategoria}</h5>
                    <p class="card-text">${element.empresas.length} Comercios</p>
                </div>
            </div>
        </div>`;
    });
}

/**
 * Captura el valor del usuario seleccionado
 */
let id;
function cambiarUsuario() {
    id = listaUsuarios.value;
}

/**
 * Carga los usuarios en un select 
 * para posteriormente poder ver las
 * ordenes del mismo
 */
function cargarUsuarios() {
const usuarios = JSON.parse(localStorage.getItem('usuarios'));
    usuarios.forEach((element, index) => {
        listaUsuarios.innerHTML += `
            <option value="${index}">${element.nombre} ${element.apellido}</option>
        `;
    });
}

/**
 * Muestra las ordenes del usuario seleccionado
 */
function mostrarOrdenes() {
    if(id !== undefined){
        const usuarios = JSON.parse(localStorage.getItem('usuarios'));
        const tituloModal = document.querySelector('#titulo-modal');
        const cuerpoModal = document.querySelector('#cuerpo-modal');
        tituloModal.innerHTML = `<h1 class="modal-title fs-5" id="exampleModalLabel">${usuarios[id].nombre}, estas son tus ordenes.</h1>`;
        cuerpoModal.innerHTML = ``;
        usuarios[id].ordenes.forEach((_, index) => {
            cuerpoModal.innerHTML += `
            <div class="card-12">
                <div class="card-body">
                    <h5 class="card-title">${usuarios[id].ordenes[index].nombreProducto}</h5>
                    <p class="card-text">${usuarios[id].ordenes[index].descripcion}</p>
                    <h6 class="card-subtitle mb-2 text-muted texto">${usuarios[id].ordenes[index].precio}</h6>
                </div>
            </div>`;
        });
    } else {
        alert('No ha seleccionado un usuario');
    }
}

/**
 * carga modal de nuevo pedido del cliente
 */
function cargarNuevoPedido(productoID){
    const categorias = JSON.parse(localStorage.getItem('categorias'));
    const producto = categorias[categoriaID].empresas[empresaID].productos[productoID];
    const modalPedido = document.querySelector('#modal-nuevo-pedido');
    const tituloModal = modalPedido.firstElementChild.firstElementChild.childNodes[1];
    const cuerpoModal = modalPedido.firstElementChild.firstElementChild.childNodes[3];
    const pieModal = modalPedido.firstElementChild.firstElementChild.childNodes[5];

    tituloModal.innerHTML = `<h1 class="modal-title fs-5" id="staticBackdropLabel">${producto.nombreProducto}</h1>
    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>`;
    cuerpoModal.innerHTML = `
    <p class="card-text">${producto.descripcion}</p>
    <form>
        <div class="mb-3">
            <label for="exampleInputEmail1" class="form-label">Cantidad a solicitar:</label>
            <input id="input-nuevo-pedido" type="number" min="1" max="30" class="form-control">
        </div>
    </form>
    <h6 class="card-subtitle mb-2 text-muted texto">${producto.precio}</h6>`;
    pieModal.innerHTML = `<button type="button" class="btn btn-primary" onClick="procesarOrden(${productoID})">ProcesarOrden</button>`;
}

function procesarOrden(productoID){
    const categorias = JSON.parse(localStorage.getItem('categorias'));
    const usuarios = JSON.parse(localStorage.getItem('usuarios'));
    const cantidad = document.querySelector('#input-nuevo-pedido');
    const producto = categorias[categoriaID].empresas[empresaID].productos[productoID];
    let nuevaOrden = {
        nombreProducto: producto.nombreProducto,
        descripcion: producto.descripcion,
        cantidad: cantidad.value,
        precio: producto.precio
    }
    usuarios[id].ordenes.push(nuevaOrden);
    localStorage.setItem('usuarios', JSON.stringify(usuarios));
}

/**
 * 
 */
function crearNuevaCategoria(){
    const categorias = JSON.parse(localStorage.getItem('categorias'));
    const formNuevaCate = document.querySelector('#form-nueva-categoria');
    const nombreNuevo = document.querySelector('#nombre-nueva-categoria').value;
    const descripcionNuevo = document.querySelector('#descripcion-nueva-categoria').value;
    const iconoNuevo = document.querySelector('#icono-nueva-categoria').value;
    const colorNuevo = document.querySelector('#color-nueva-categoria').value;
    const empresaNueva = document.querySelector('#empresa-nueva-categoria');
    const iconos = ['fa-sharp fa-solid fa-globe', 'fa-light fa-command', 'fa-solid fa-flask-vial', 'fa-solid fa-bolt-lightning'];
    let empresaNuevaSeleccionada = [...empresaNueva.selectedOptions].map(option => option.value);
    let empresafinal = [];
    empresaNuevaSeleccionada.forEach((_, index) => {
        empresafinal[index] = selectEmpresas[index];
    });
    
    let nuevaCategoria = {
        nombreCategoria: nombreNuevo,
        descripcion: descripcionNuevo,
        color: colorNuevo,
        icono: iconos[iconoNuevo],
        empresas:empresafinal
    }
    categorias.push(nuevaCategoria);
    localStorage.setItem('categorias', JSON.stringify(categorias));
    resetApps(divCategorias);
    cargarCategorias();
    formNuevaCate.reset();
}

/**
 * Limpia las apps que se cargan dependiendo de la categoria
 */
function resetApps(e) {
    while (e.firstChild) {
        e.removeChild(e.firstChild);
    }
}
